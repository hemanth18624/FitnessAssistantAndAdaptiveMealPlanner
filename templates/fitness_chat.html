<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitness AI Assistant</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
/* ================= THEME ================= */
:root {
  --primary: #2563eb;
  --primary-dark: #1e40af;
  --accent: #22d3ee;
  --ai-bg: #f1f5f9;
  --user-bg: linear-gradient(135deg, #2563eb, #3b82f6);
  --glass: rgba(255,255,255,0.96);
}

/* ================= PAGE ================= */
body {
  min-height: 100vh;
  background:
    radial-gradient(600px circle at top, #1e293b 0%, #020617 60%);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
  font-family: "Inter", system-ui, sans-serif;
}

/* ================= CONTAINER ================= */
.chat-container {
  width: 100%;
  max-width: 430px;
  height: 760px;
  background: var(--glass);
  backdrop-filter: blur(22px);
  border-radius: 28px;
  box-shadow:
    0 50px 120px rgba(0,0,0,0.55),
    inset 0 0 0 1px rgba(255,255,255,0.5);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  animation: popIn 0.55s ease-out forwards;
}

/* ================= HEADER ================= */
.chat-header {
  padding: 22px;
  background:
    linear-gradient(135deg, #2563eb, #3b82f6);
  color: white;
  text-align: center;
  position: relative;
}

.chat-header::after {
  content: "";
  position: absolute;
  left: 18px;
  right: 18px;
  bottom: 0;
  height: 1px;
  background: rgba(255,255,255,0.25);
}

.chat-header h4 {
  margin: 0;
  font-weight: 600;
  letter-spacing: 0.4px;
}

.chat-header span {
  font-size: 0.82rem;
  opacity: 0.9;
}

/* ================= CHAT BODY ================= */
#chat-box {
  flex: 1;
  padding: 22px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 14px;
  scroll-behavior: smooth;
}

/* Scrollbar */
#chat-box::-webkit-scrollbar {
  width: 6px;
}
#chat-box::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.15);
  border-radius: 20px;
}

/* ================= MESSAGES ================= */
.message {
  max-width: 82%;
  padding: 14px 16px;
  border-radius: 18px;
  font-size: 0.93rem;
  line-height: 1.55;
  animation: slideIn 0.28s ease forwards;
  box-shadow:
    0 6px 18px rgba(0,0,0,0.08);
}

/* AI */
.ai-msg {
  background: linear-gradient(180deg, #f8fafc, #eef2f7);
  align-self: flex-start;
  border-top-left-radius: 6px;
}

/* USER */
.user-msg {
  background: var(--user-bg);
  color: white;
  align-self: flex-end;
  border-top-right-radius: 6px;
  box-shadow: 0 10px 28px rgba(37,99,235,0.35);
}

/* ================= TYPING ================= */
.typing {
  display: none;
  padding: 8px 22px;
  font-size: 0.8rem;
  color: #64748b;
  animation: pulse 1.2s infinite;
}

/* ================= INPUT ================= */
.chat-input {
  padding: 18px;
  border-top: 1px solid #e5e7eb;
  background: rgba(255,255,255,0.98);
}

.chat-input .input-group {
  gap: 10px;
}

.chat-input input {
  border-radius: 18px;
  padding: 14px 16px;
  border: 1px solid #d1d5db;
  font-size: 0.9rem;
}

.chat-input input::placeholder {
  color: #94a3b8;
}

.chat-input input:focus {
  border-color: var(--primary);
  box-shadow:
    0 0 0 3px rgba(37,99,235,0.18);
}

/* Button */
.chat-input button {
  border-radius: 18px;
  background: linear-gradient(135deg, #2563eb, #3b82f6);
  border: none;
  padding: 12px 20px;
  font-weight: 500;
  transition: all 0.25s ease;
}

.chat-input button:hover {
  background: linear-gradient(135deg, #1e40af, #2563eb);
  transform: translateY(-1px);
  box-shadow: 0 10px 25px rgba(37,99,235,0.4);
}

/* ================= ANIMATIONS ================= */
@keyframes slideIn {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes popIn {
  from { opacity: 0; transform: scale(0.96); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes pulse {
  0% { opacity: 0.35; }
  50% { opacity: 1; }
  100% { opacity: 0.35; }
}
</style>
</head>

<body>

<div class="chat-container">

  <div class="chat-header">
    <h4>Fitness AI Assistant</h4>
    <span>Workouts Â· Recovery Â· Fat Loss Â· Muscle Gain</span>
  </div>

  <div id="chat-box">
    <div class="message ai-msg">
      ðŸ‘‹ <strong>Hi!</strong> Iâ€™m your Fitness AI Assistant.<br>
      Ask me about workouts, injuries, fat loss, muscle gain, or recovery.
    </div>
  </div>

  <div id="typing" class="typing">AI is thinkingâ€¦</div>

  <div class="chat-input">
    <div class="input-group">
      <input id="user-input" class="form-control" placeholder="Ask a fitness questionâ€¦">
      <button class="btn btn-primary" onclick="sendMessage()">Send</button>
    </div>
  </div>

</div>

<script>
const chatBox = document.getElementById("chat-box");
const userInput = document.getElementById("user-input");
const typing = document.getElementById("typing");

function appendMessage(text, className) {
  const div = document.createElement("div");
  div.className = `message ${className}`;
  div.style.whiteSpace = "pre-wrap";
  div.innerHTML = text;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
}

async function sendMessage() {
  const message = userInput.value.trim();
  if (!message) return;

  appendMessage(message, "user-msg");
  userInput.value = "";
  typing.style.display = "block";

  try {
    const response = await fetch("/fitness-message", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message })
    });
    const data = await response.json();
    typing.style.display = "none";
    appendMessage(data.reply, "ai-msg");
  } catch {
    typing.style.display = "none";
    appendMessage("âš ï¸ Something went wrong. Please try again.", "ai-msg");
  }
}

userInput.addEventListener("keypress", e => {
  if (e.key === "Enter") sendMessage();
});
</script>

</body>
</html>
